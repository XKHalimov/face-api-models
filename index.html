<!DOCTYPE html>
<html lang="uz">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Maktab Davomat Tizimi</title>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/@vladmandic/face-api@1.7.12/dist/face-api.min.js"
    ></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }

      h1 {
        text-align: center;
        color: #1e3c72;
        margin-bottom: 10px;
        font-size: 2.5em;
      }

      .subtitle {
        text-align: center;
        color: #666;
        margin-bottom: 30px;
        font-size: 1.2em;
      }

      .main-grid {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
      }

      .left-panel {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .video-container {
        position: relative;
        background: #000;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      video,
      canvas {
        width: 100%;
        height: auto;
        display: block;
      }

      canvas {
        position: absolute;
        top: 0;
        left: 0;
      }

      .control-panel {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        border: 2px solid #e9ecef;
      }

      .control-panel h3 {
        color: #495057;
        margin-bottom: 15px;
        font-size: 1.3em;
      }

      .button-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }

      button {
        padding: 12px;
        background: #1e3c72;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s;
        font-weight: bold;
      }

      button:hover {
        background: #2a5298;
        transform: translateY(-2px);
        box-shadow: 0 5px 15px rgba(30, 60, 114, 0.4);
      }

      button:disabled {
        background: #adb5bd;
        cursor: not-allowed;
        transform: none;
      }

      .btn-success {
        background: #28a745;
      }

      .btn-success:hover {
        background: #218838;
      }

      .btn-danger {
        background: #dc3545;
      }

      .btn-danger:hover {
        background: #c82333;
      }

      .btn-warning {
        background: #ffc107;
        color: #000;
      }

      .btn-warning:hover {
        background: #e0a800;
      }

      .status {
        padding: 15px;
        background: #d1ecf1;
        border: 2px solid #bee5eb;
        border-radius: 8px;
        color: #0c5460;
        font-weight: 500;
        text-align: center;
      }

      .status.success {
        background: #d4edda;
        border-color: #c3e6cb;
        color: #155724;
      }

      .status.error {
        background: #f8d7da;
        border-color: #f5c6cb;
        color: #721c24;
      }

      .right-panel {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .stats-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
      }

      .stats-card h3 {
        font-size: 3em;
        margin: 10px 0;
      }

      .stats-card p {
        font-size: 1.2em;
        opacity: 0.9;
      }

      .attendance-list {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        max-height: 400px;
        overflow-y: auto;
      }

      .attendance-list h3 {
        color: #495057;
        margin-bottom: 15px;
        position: sticky;
        top: 0;
        background: #f8f9fa;
        padding-bottom: 10px;
      }

      .attendance-item {
        background: white;
        padding: 12px;
        border-radius: 8px;
        margin-bottom: 8px;
        border: 2px solid #e9ecef;
        display: flex;
        justify-content: space-between;
        align-items: center;
        animation: slideIn 0.3s ease;
      }

      .attendance-info {
        display: flex;
        flex-direction: column;
        gap: 3px;
      }

      .attendance-date {
        font-size: 0.85em;
        color: #888;
        font-style: italic;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .attendance-item.present {
        border-left: 5px solid #28a745;
      }

      .attendance-time {
        font-size: 0.9em;
        color: #666;
      }

      .students-section {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin-top: 20px;
      }

      .students-section h3 {
        color: #495057;
        margin-bottom: 15px;
      }

      .student-form {
        display: grid;
        grid-template-columns: 2fr 1fr auto;
        gap: 10px;
        margin-bottom: 15px;
      }

      @media (max-width: 768px) {
        .student-form {
          grid-template-columns: 1fr;
        }
      }

      input[type="text"] {
        flex: 1;
        padding: 10px;
        border: 2px solid #dee2e6;
        border-radius: 5px;
        font-size: 16px;
      }

      .students-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 10px;
        max-height: 300px;
        overflow-y: auto;
      }

      .student-card {
        background: white;
        padding: 12px;
        border-radius: 8px;
        border: 2px solid #e9ecef;
        display: flex;
        flex-direction: column;
        gap: 5px;
      }

      .student-card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
      }

      .student-class {
        font-size: 0.85em;
        color: #6c757d;
        background: #e9ecef;
        padding: 3px 8px;
        border-radius: 4px;
        display: inline-block;
      }

      .delete-btn {
        padding: 5px 10px;
        background: #dc3545;
        font-size: 14px;
        border-radius: 5px;
      }

      .export-section {
        background: #fff3cd;
        padding: 15px;
        border-radius: 8px;
        margin-top: 20px;
        border: 2px solid #ffeaa7;
      }

      .export-section h3 {
        color: #856404;
        margin-bottom: 10px;
      }

      @media (max-width: 768px) {
        .main-grid {
          grid-template-columns: 1fr;
        }

        .button-grid {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üè´ Maktab Davomat Tizimi</h1>
      <p class="subtitle">Yuz tanish orqali avtomatik davomat</p>

      <div id="status" class="status">Model yuklanmoqda...</div>

      <div class="main-grid">
        <div class="left-panel">
          <div class="video-container">
            <video id="video" autoplay muted></video>
            <canvas id="canvas"></canvas>
          </div>

          <div class="control-panel">
            <h3>üéõÔ∏è Boshqaruv Paneli</h3>
            <div class="button-grid">
              <button id="startBtn" onclick="kameraniYoqish()">
                üìπ Kamerani Yoqish
              </button>
              <button
                id="stopBtn"
                class="btn-danger"
                onclick="kameraniOchirish()"
                disabled
              >
                ‚èπÔ∏è To'xtatish
              </button>
              <button
                id="startAttendanceBtn"
                class="btn-success"
                onclick="davomatniYoqish()"
                disabled
              >
                ‚úÖ Davomatni Boshlash
              </button>
              <button
                id="stopAttendanceBtn"
                class="btn-warning"
                onclick="davomatniTo—Ötatish()"
                disabled
              >
                ‚è∏Ô∏è Pauza
              </button>
            </div>
          </div>
        </div>

        <div class="right-panel">
          <div class="stats-card">
            <p>Bugungi Davomat</p>
            <h3 id="attendanceCount">0</h3>
            <p id="currentDate"></p>
          </div>

          <div class="attendance-list">
            <h3>üìã Bugun Kelgan O'quvchilar</h3>
            <div id="attendanceList">Ma'lumot yo'q</div>
          </div>
        </div>
      </div>

      <div class="students-section">
        <h3>üë®‚Äçüéì O'quvchilarni Ro'yxatga Olish</h3>
        <div class="student-form">
          <input
            type="text"
            id="studentName"
            placeholder="O'quvchi ismi va familiyasi..."
          />
          <input
            type="text"
            id="studentClass"
            placeholder="Guruh/Sinf (masalan: 9-A)"
          />
          <button onclick="oquvchiQoshish()" id="addStudentBtn" disabled>
            ‚ûï Yuz Skanerlash
          </button>
        </div>
        <div class="students-grid" id="studentsList">Ma'lumot yo'q</div>
      </div>

      <div class="export-section">
        <h3>üìä Hisobotlar</h3>
        <div class="button-grid">
          <button onclick="hisobotniYuklash()">
            üíæ Bugungi Hisobotni Yuklash
          </button>
          <button onclick="davomatniTozalash()" class="btn-danger">
            üóëÔ∏è Bugungi Davomatni Tozalash
          </button>
          <button onclick="haqidaKorsatish()">‚ÑπÔ∏è Ma'lumot</button>
          <button onclick="barqarorlikniTekshirish()">
            üîß Tizimni Tekshirish
          </button>
        </div>
      </div>
    </div>

    <script>
      let video = document.getElementById("video");
      let canvas = document.getElementById("canvas");
      let statusDiv = document.getElementById("status");
      let stream = null;
      let recognitionInterval = null;

      let students = [];
      let todayAttendance = [];
      let lastRecognizedTime = {};

      const RECOGNITION_COOLDOWN = 30000; // 30 soniya

      function bugungiSana() {
        const today = new Date();
        return today.toISOString().split("T")[0];
      }

      function sananiFormatlash(date) {
        const d = new Date(date);
        return d.toLocaleString("uz-UZ", {
          year: "numeric",
          month: "long",
          day: "numeric",
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      function sananiToliFormatlash(date) {
        const d = new Date(date);
        return d.toLocaleDateString("uz-UZ", {
          year: "numeric",
          month: "long",
          day: "numeric",
        });
      }

      function vaqtniFormatlash(date) {
        const d = new Date(date);
        return d.toLocaleTimeString("uz-UZ", {
          hour: "2-digit",
          minute: "2-digit",
        });
      }

      async function modellarniYuklash() {
        try {
          statusDiv.textContent =
            "‚è≥ Yuz tanish modellari yuklanmoqda... (10-20 soniya)";

          if (typeof faceapi === "undefined") {
            throw new Error(
              "face-api.js kutubxonasi yuklanmadi! Internet aloqasini tekshiring."
            );
          }

          const MODEL_URL =
            "https://cdn.jsdelivr.net/npm/@vladmandic/face-api@1.7.12/model";

          await faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL);
          await faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL);
          await faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL);

          statusDiv.className = "status success";
          statusDiv.textContent = "‚úÖ Tizim tayyor! Kamerani yoqing.";
          document.getElementById("startBtn").disabled = false;

          malumotlarniYuklash();
          joriyVaqtniYangilash();
        } catch (error) {
          statusDiv.className = "status error";
          statusDiv.textContent = "‚ùå Xato: " + error.message;
          console.error("Model yuklash xatosi:", error);
        }
      }

      function joriyVaqtniYangilash() {
        const dateEl = document.getElementById("currentDate");
        dateEl.textContent = sananiFormatlash(new Date());
        setInterval(() => {
          dateEl.textContent = sananiFormatlash(new Date());
        }, 60000);
      }

      async function kameraniYoqish() {
        try {
          statusDiv.className = "status";
          statusDiv.textContent = "‚è≥ Kamera yoqilmoqda...";

          stream = await navigator.mediaDevices.getUserMedia({
            video: { width: { ideal: 1280 }, height: { ideal: 720 } },
            audio: false,
          });

          video.srcObject = stream;

          await new Promise((resolve) => {
            video.onloadedmetadata = () => {
              video.play();
              canvas.width = video.videoWidth;
              canvas.height = video.videoHeight;
              resolve();
            };
          });

          document.getElementById("startBtn").disabled = true;
          document.getElementById("stopBtn").disabled = false;
          document.getElementById("addStudentBtn").disabled = false;
          document.getElementById("startAttendanceBtn").disabled = false;

          statusDiv.className = "status success";
          statusDiv.textContent =
            "üìπ Kamera faol! Davomatni boshlashingiz mumkin.";
        } catch (error) {
          statusDiv.className = "status error";
          statusDiv.textContent = "‚ùå Kamera xatosi: " + error.message;
          console.error(error);
        }
      }

      function kameraniOchirish() {
        if (stream) {
          stream.getTracks().forEach((track) => track.stop());
          video.srcObject = null;
        }

        davomatniTo—Ötatish();

        document.getElementById("startBtn").disabled = false;
        document.getElementById("stopBtn").disabled = true;
        document.getElementById("addStudentBtn").disabled = true;
        document.getElementById("startAttendanceBtn").disabled = true;

        statusDiv.className = "status";
        statusDiv.textContent = "Kamera o'chirildi.";
      }

      async function oquvchiQoshish() {
        const name = document.getElementById("studentName").value.trim();
        const studentClass = document
          .getElementById("studentClass")
          .value.trim();

        if (!name) {
          alert("Iltimos, o'quvchi ismi va familiyasini kiriting!");
          return;
        }

        if (!studentClass) {
          alert("Iltimos, guruh/sinfni kiriting!");
          return;
        }

        if (students.some((s) => s.name.toLowerCase() === name.toLowerCase())) {
          alert("Bu o'quvchi allaqachon ro'yxatda!");
          return;
        }

        statusDiv.className = "status";
        statusDiv.textContent = "üì∏ Yuz skanerlanyapti...";

        try {
          const detections = await faceapi
            .detectSingleFace(video, new faceapi.TinyFaceDetectorOptions())
            .withFaceLandmarks()
            .withFaceDescriptor();

          if (detections) {
            students.push({
              name: name,
              class: studentClass,
              descriptor: Array.from(detections.descriptor),
              id: Date.now(),
              addedDate: new Date().toISOString(),
            });

            localStorage.setItem("students", JSON.stringify(students));

            statusDiv.className = "status success";
            statusDiv.textContent = `‚úÖ ${name} (${studentClass}) muvaffaqiyatli ro'yxatga olindi!`;

            document.getElementById("studentName").value = "";
            document.getElementById("studentClass").value = "";
            oquvchilarniKorsatish();
          } else {
            statusDiv.className = "status error";
            statusDiv.textContent =
              "‚ùå Yuz aniqlanmadi! Kameraga to'g'ri qarang.";
          }
        } catch (error) {
          statusDiv.className = "status error";
          statusDiv.textContent = "‚ùå Xato yuz berdi!";
          console.error(error);
        }
      }

      function davomatniYoqish() {
        if (students.length === 0) {
          alert("Avval o'quvchilarni ro'yxatga oling!");
          return;
        }

        document.getElementById("startAttendanceBtn").disabled = true;
        document.getElementById("stopAttendanceBtn").disabled = false;

        statusDiv.className = "status success";
        statusDiv.textContent =
          "üîç Davomat yozilmoqda... O'quvchilar kameraga qarashsin.";

        recognitionInterval = setInterval(yuzniTanishVaDavomatQilish, 500);
      }

      function davomatniTo—Ötatish() {
        if (recognitionInterval) {
          clearInterval(recognitionInterval);
          recognitionInterval = null;
        }

        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        document.getElementById("startAttendanceBtn").disabled = false;
        document.getElementById("stopAttendanceBtn").disabled = true;

        statusDiv.className = "status";
        statusDiv.textContent = "‚è∏Ô∏è Davomat to'xtatildi.";
      }

      async function yuzniTanishVaDavomatQilish() {
        const detections = await faceapi
          .detectAllFaces(video, new faceapi.TinyFaceDetectorOptions())
          .withFaceLandmarks()
          .withFaceDescriptors();

        const ctx = canvas.getContext("2d");
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        const currentTime = Date.now();
        const today = bugungiSana();

        detections.forEach((detection) => {
          const box = detection.detection.box;

          let bestMatch = {
            name: "Noma'lum",
            distance: 0.5,
            studentId: null,
            class: "",
          };

          students.forEach((student) => {
            const distance = faceapi.euclideanDistance(
              detection.descriptor,
              new Float32Array(student.descriptor)
            );

            if (distance < bestMatch.distance) {
              bestMatch = {
                name: student.name,
                distance: distance,
                studentId: student.id,
                class: student.class || "",
              };
            }
          });

          const color = bestMatch.name === "Noma'lum" ? "#dc3545" : "#28a745";
          ctx.strokeStyle = color;
          ctx.lineWidth = 4;
          ctx.strokeRect(box.x, box.y, box.width, box.height);

          ctx.fillStyle = color;
          ctx.font = "bold 24px Arial";
          const text = `${bestMatch.name} (${Math.round(
            (1 - bestMatch.distance) * 100
          )}%)`;
          ctx.fillText(text, box.x, box.y - 10);

          if (bestMatch.studentId && bestMatch.name !== "Noma'lum") {
            const lastTime = lastRecognizedTime[bestMatch.studentId] || 0;

            if (currentTime - lastTime > RECOGNITION_COOLDOWN) {
              const alreadyPresent = todayAttendance.some(
                (a) => a.studentId === bestMatch.studentId && a.date === today
              );

              if (!alreadyPresent) {
                todayAttendance.push({
                  studentId: bestMatch.studentId,
                  name: bestMatch.name,
                  class: bestMatch.class,
                  time: new Date().toISOString(),
                  date: today,
                });

                localStorage.setItem(
                  "todayAttendance",
                  JSON.stringify(todayAttendance)
                );

                lastRecognizedTime[bestMatch.studentId] = currentTime;

                davomatniKorsatish();
                ovozChiqarish();
              }
            }
          }
        });
      }

      function ovozChiqarish() {
        const audio = new Audio(
          "data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUKnn77RgGwU7k9n0yXEpBSh+zO/hlkULEly06+ypVxQKRaDe8bllHAU2jdXy0IAqBSh9zO/hlkULEl206+ypVxQKRaDe8bllHAU2jdXy0IAqBSh9zO/hlkULEl206+ypVxQKRaDe8bllHAU2jdXy0IAqBSh9zO/hlkULEl206+ypVxQKRaDe8bllHAU2jdXy0IAqBSh9zO/hlkULEl206+ypVxQKRaDe8bllHAU2jdXy0IAqBQ=="
        );
        audio.play().catch(() => {});
      }

      function oquvchilarniKorsatish() {
        const list = document.getElementById("studentsList");
        if (students.length === 0) {
          list.innerHTML = "Hali o'quvchilar ro'yxatga olinmagan";
        } else {
          list.innerHTML = students
            .map(
              (student) => `
                    <div class="student-card">
                        <div class="student-card-header">
                            <div>
                                <strong>${student.name}</strong>
                                <div class="student-class">${
                                  student.class || "Guruh ko'rsatilmagan"
                                }</div>
                            </div>
                            <button class="delete-btn" onclick="oquvchiOchirish(${
                              student.id
                            })">O'chirish</button>
                        </div>
                    </div>
                `
            )
            .join("");
        }
      }

      function davomatniKorsatish() {
        const today = bugungiSana();
        const todayList = todayAttendance.filter((a) => a.date === today);

        document.getElementById("attendanceCount").textContent =
          todayList.length;

        const list = document.getElementById("attendanceList");
        if (todayList.length === 0) {
          list.innerHTML = "Hali hech kim kelmagan";
        } else {
          list.innerHTML = todayList
            .sort((a, b) => new Date(b.time) - new Date(a.time))
            .map(
              (record) => `
                    <div class="attendance-item present">
                        <div class="attendance-info">
                            <strong>${record.name}</strong>
                            <div class="student-class" style="margin: 3px 0;">${
                              record.class || "Guruh noma'lum"
                            }</div>
                            <div class="attendance-time">‚è∞ ${vaqtniFormatlash(
                              record.time
                            )}</div>
                            <div class="attendance-date">üìÖ ${sananiToliFormatlash(
                              record.time
                            )}</div>
                        </div>
                        <span style="color: #28a745; font-size: 1.5em;">‚úì</span>
                    </div>
                `
            )
            .join("");
        }
      }

      function oquvchiOchirish(id) {
        if (confirm("Rostdan ham bu o'quvchini o'chirmoqchimisiz?")) {
          students = students.filter((s) => s.id !== id);
          localStorage.setItem("students", JSON.stringify(students));
          oquvchilarniKorsatish();

          statusDiv.className = "status success";
          statusDiv.textContent = "‚úÖ O'quvchi o'chirildi!";
        }
      }

      function davomatniTozalash() {
        if (
          confirm(
            "Bugungi barcha davomat yozuvlari o'chiriladi. Davom etasizmi?"
          )
        ) {
          const today = bugungiSana();
          todayAttendance = todayAttendance.filter((a) => a.date !== today);
          localStorage.setItem(
            "todayAttendance",
            JSON.stringify(todayAttendance)
          );
          davomatniKorsatish();

          statusDiv.className = "status success";
          statusDiv.textContent = "‚úÖ Bugungi davomat tozalandi!";
        }
      }

      function hisobotniYuklash() {
        const today = bugungiSana();
        const todayList = todayAttendance.filter((a) => a.date === today);

        if (todayList.length === 0) {
          alert("Bugun hech kim davomat qilinmagan!");
          return;
        }

        let csv = "Ism,Familiya,Guruh/Sinf,Kelgan Vaqt,Sana\n";
        todayList.forEach((record) => {
          const [ism, ...familiya] = record.name.split(" ");
          const sana = sananiToliFormatlash(record.time);
          const guruh = record.class || "Noma'lum";
          csv += `${ism},${familiya.join(" ")},${guruh},${vaqtniFormatlash(
            record.time
          )},${sana}\n`;
        });

        const blob = new Blob(["\ufeff" + csv], {
          type: "text/csv;charset=utf-8;",
        });
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = `davomat_${today}.csv`;
        link.click();

        statusDiv.className = "status success";
        statusDiv.textContent = "‚úÖ Hisobot yuklab olindi!";
      }

      function haqidaKorsatish() {
        alert(`
üè´ MAKTAB DAVOMAT TIZIMI

Bu tizim o'quvchilarning davomatini yuz tanish texnologiyasi orqali avtomatik ravishda qayd qiladi.

QANDAY ISHLAYDI:
1. O'quvchilarni bir marta ro'yxatga oling
2. Har kuni kamerani yoqing va "Davomatni Boshlash" ni bosing
3. O'quvchilar kameradan o'tganda avtomatik davomat qilinadi
4. Kunlik hisobotlarni CSV formatda yuklab oling

XAVFSIZLIK:
‚Ä¢ Ma'lumotlar faqat kompyuterda saqlanadi
‚Ä¢ Internetga yuborilmaydi
‚Ä¢ Har qanday vaqt o'chirish mumkin

Yaratuvchi: Claude (Anthropic)
Versiya: 1.0
        `);
      }

      function barqarorlikniTekshirish() {
        const checks = [];

        checks.push(`‚úÖ O'quvchilar soni: ${students.length} ta`);
        checks.push(
          `‚úÖ Bugungi davomat: ${
            todayAttendance.filter((a) => a.date === bugungiSana()).length
          } ta`
        );
        checks.push(`‚úÖ Jami davomat yozuvlari: ${todayAttendance.length} ta`);
        checks.push(
          `${stream ? "‚úÖ" : "‚ùå"} Kamera holati: ${
            stream ? "Faol" : "O'chirilgan"
          }`
        );
        checks.push(
          `${recognitionInterval ? "‚úÖ" : "‚è∏Ô∏è"} Davomat holati: ${
            recognitionInterval ? "Yozilmoqda" : "To'xtatilgan"
          }`
        );

        alert("üîß TIZIM HOLATI\n\n" + checks.join("\n"));
      }

      function malumotlarniYuklash() {
        const savedStudents = localStorage.getItem("students");
        if (savedStudents) {
          students = JSON.parse(savedStudents);
        }

        const savedAttendance = localStorage.getItem("todayAttendance");
        if (savedAttendance) {
          todayAttendance = JSON.parse(savedAttendance);
        }

        oquvchilarniKorsatish();
        davomatniKorsatish();
      }

      window.addEventListener("load", modellarniYuklash);
    </script>
  </body>
</html>
